<!DOCTYPE html>
<html lang="en-us">

  <head>
  <meta charset="utf-8">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <title>Paper Results</title>
  <meta name="author" content="Mariachiara Fortuna" />
  
  
  
  
  <meta name="keywords" content="R, coding, research, temperature, FGN">
  
  
  <meta name="description" content="">

  <meta name="generator" content="Hugo 0.70.0" />

  
  <link href='//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,500,700,800' rel='stylesheet' type='text/css'>

  
  <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.11.2/css/all.css">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  
  <link href="/css/animate.css" rel="stylesheet">

  
  
    <link href="/css/style.vanlog.css" rel="stylesheet" id="theme-stylesheet">
  

  
  <link href="/css/custom.css" rel="stylesheet">

  
  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png" />

  
  <link href="/css/owl.carousel.css" rel="stylesheet">
  <link href="/css/owl.theme.css" rel="stylesheet">

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Temperature">

  
  
  
  
  
  
  
  <meta property="og:locale" content="en_us">
  <meta property="og:site_name" content="Temperature">
  <meta property="og:title" content="Paper Results">
  <meta property="og:type" content="website">
  <meta property="og:url" content="/temperature/paper-results/" />
  <meta property="og:description" content="">
  <meta property="og:image" content="/img/banners/banner-1.jpg">
  <meta property="og:image:type" content="image/jpg">
  
  
  
    <meta property="og:image:width" content="1000">
    <meta property="og:image:height" content="750">
  
  
  <meta property="og:updated_time" content="2020-04-17T00:00:00Z">
  

  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:title" content="Paper Results">
  
  <meta name="twitter:image" content="/img/banners/banner-1.jpg">
  
  <meta name="twitter:description" content="">
  

</head>


  <body>

    <div id="all">

        <header>

          <div class="navbar-affixed-top" data-spy="affix" data-offset-top="200">

    <div class="navbar navbar-default yamm" role="navigation" id="navbar">

        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand home" href="/">
                    <img src="/img/vanlog_retina3.png" alt="Paper Results logo" class="hidden-xs hidden-sm" >
                    <img src="/img/vanlog_retina3.png" alt="Paper Results logo" class="visible-xs visible-sm">
                    <span class="sr-only">Paper Results - go to homepage</span>
                </a>
                <div class="navbar-buttons">
                    <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse" data-target="#navigation">
                      <span class="sr-only">Toggle Navigation</span>
                        <i class="fas fa-align-justify"></i>
                    </button>
                </div>
            </div>
            

            <div class="navbar-collapse collapse" id="navigation">
                <ul class="nav navbar-nav navbar-right">
                  
                  
                  
                  <li class="dropdown">
                    
                    <a href="/">Home</a>
                    
                  </li>
                  
                  
                  <li class="dropdown">
                    
                    <a href="/contact/">Contact</a>
                    
                  </li>
                  
                  
                  <li class="dropdown active">
                    
                    <a href="/temperature/">temperature</a>
                    
                  </li>
                  
                </ul>
            </div>
            

            <div class="collapse clearfix" id="search">

                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search">
                        <span class="input-group-btn">

                    <button type="submit" class="btn btn-template-main"><i class="fas fa-search"></i></button>

                </span>
                    </div>
                </form>

            </div>
            

        </div>
    </div>
    

</div>




        </header>

        <div id="heading-breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h1>Paper Results</h1>
            </div>
        </div>
    </div>
</div>


        <div id="content">
            <div class="container">

                <div class="row">

                    

                    <div class="col-md-9" id="blog-post">

                        
                          <p class="text-muted text-uppercase mb-small text-right">
                            By <a href="#">Mariachiara Fortuna</a>
                             | 
                            April 17, 2020
                          </p>
                        

                        <div id="post-content">
                          


<p><strong>Affiliations:</strong></p>
<p>John K. Dagsvik, Statistics Norway, Research Department;</p>
<p>Mariachiara Fortuna, freelance statistician, Turin;</p>
<p>Sigmund Hov Moen, Westerdals Oslo School of Arts, Communication and Technology.</p>
<p><strong>Corresponding author:</strong></p>
<p>John K. Dagsvik, E-mail: <a href="mailto:john.dagsvik@ssb.no" class="email">john.dagsvik@ssb.no</a></p>
<p>Mariachiara Fortuna, E-mail: <a href="mailto:mariachiara.fortuna@vanlog.it" class="email">mariachiara.fortuna@vanlog.it</a> (reference for code and analysis)</p>
<pre class="r"><code>#library(tempFGN)
library(knitr)
library(dplyr)
library(tidyr)
library(ggplot2)</code></pre>
<pre class="r"><code># DATA PATH
data_final_path &lt;- file.path(&quot;data&quot;,&quot;final&quot;)
data_supporting_path &lt;- file.path(&quot;data&quot;, &quot;supporting&quot;)
data_moberg_path &lt;- file.path(&quot;data&quot;, &quot;moberg&quot;)

# OUTPUT PATH
output_supporting_path &lt;- file.path(&quot;output&quot;, &quot;supporting&quot;)
output_table_path &lt;- file.path(&quot;output&quot;, &quot;table&quot;)
output_figure_path &lt;- file.path(&quot;output&quot;, &quot;figure&quot;)
output_temporary_path &lt;- file.path(&quot;output&quot;, &quot;temporary&quot;)
output_manipuated_path &lt;- file.path(&quot;output&quot;, &quot;manipulated&quot;)</code></pre>
<pre class="r"><code># ACCESS TO SELECTED TIME SERIES
selected &lt;- read.csv(file.path(data_supporting_path, &quot;T0.SelInfo.csv&quot;), sep=&quot;;&quot;, dec=&quot;,&quot;)
country_sel &lt;- selected$Country
station_sel &lt;- selected$Station
njs &lt;- nrow(selected)
data_dir_sel &lt;- file.path(data_final_path, country_sel, paste0(station_sel, &quot;.txt&quot;))
stationame_sel &lt;- paste0(country_sel,&quot;, &quot;,station_sel)

# ACCESS TO ALL THE TIME SERIES
all &lt;- read.csv(file.path(data_supporting_path, &quot;T0.TempInfo.csv&quot;), sep=&quot;;&quot;, dec=&quot;,&quot;)
country_all &lt;- all$Country
station_all &lt;- all$Station
nja &lt;- nrow(all)
data_dir_all &lt;- file.path(data_final_path, country_all, paste0(station_all, &quot;.txt&quot;))
stationame_all &lt;- paste0(country_all,&quot;, &quot;,station_all)

# ACCESS TO MOBERG DATA
moberg &lt;- read.table(file.path(data_moberg_path, &quot;Moberg data.txt&quot;),
                   header = T, na.strings = 99)
Year_m &lt;- moberg[, 1]
Xj_m &lt;- moberg[, 2]
Zj_m &lt;- scale(Xj_m)
Yj_m &lt;- cumsum(Zj_m)</code></pre>
<hr />
<hr />
<div id="tables" class="section level1">
<h1>TABLES</h1>
<div id="table-1.-parameter-estimation-for-the-selected-time-series" class="section level3">
<h3>Table 1. Parameter estimation for the selected time series</h3>
<p>Estimation results for selected cities based on characteristic function regression and Whittle MLE method. Monthly data.</p>
<pre class="r"><code>#====== NOT RUN, needs about 10 minute to run
#--- 0b. Parameters table
Parameters &lt;- matrix(0, nrow=njs, ncol=6)
colnames(Parameters) &lt;- c(&quot;Mu&quot;,&quot;Sigma&quot;,&quot;Hc&quot;,&quot;Hw&quot;,&quot;SE_Hw&quot;,&quot;Alpha&quot;)
rownames(Parameters) &lt;- paste0(selected$Country,&quot;, &quot;,selected$Station)

for (j in 1:njs) {
        #--- 1. Data reading 
        data &lt;- read.delim(data_dir_sel[j], header=F, na.strings=99)
        Zm &lt;- monthlyAdj(data, scale=T)$Zm
        
        #--- 2. Estimation
        Parameters[j,1] &lt;- estim.cf.mu(Zj=Zm) #+ mu_Xj
        Parameters[j,2] &lt;- estim.cf.sigma(Yj=Zm, FBM=F) #* sd_Xj  
        Parameters[j,3] &lt;- estim.cf.H(Yj=Zm, FBM=F)
        Parameters[j,4] &lt;- estim.w.H(Zj=Zm)
        Parameters[j,5] &lt;- WhittleEst(Zm)$coefficients[2]
        Parameters[j,6] &lt;- estim.cf.alpha(Yj=Zm, FBM=F)
        }

Parameters &lt;- as.data.frame(Parameters)
write.csv(Parameters, file.path(output_supporting_path, 
                                &quot;T1a_selected_parameters_estim.csv&quot;)) </code></pre>
<pre class="r"><code>#=== T1a READING 
T1a.selParam &lt;- read.csv(file.path(output_supporting_path,
                                   &quot;T1a_selected_parameters_estim.csv&quot;))</code></pre>
<pre class="r"><code>#--- 0a. Selected data reading
Hvec &lt;- T1a.selParam$Hc

#--- 0b. Matrix and parameters setting
Boots &lt;- matrix(0, nrow=njs, ncol=4)
colnames(Boots) &lt;- c(&quot;SE_Mu&quot;, &quot;SE_Sigma&quot;, &quot;SE_Hc&quot;, &quot;SE_Alpha&quot;)
rownames(Boots) &lt;- T1a.selParam[,1]

N &lt;- 1000
Tlenght &lt;- 2000 
for (j in 1:njs){ 
          H &lt;- Hvec[j]
          Parameters &lt;- matrix(0, nrow=N, ncol=4)
          colnames(Parameters) &lt;- c(&quot;Mu&quot;, &quot;Sigma&quot;, &quot;Hc&quot;, &quot;Alpha&quot;)
          for (i in 1:N){
                         Zjsim &lt;- SimulateFGN(Tlenght, H)
                         Parameters[i,1] &lt;- estim.cf.mu(Zj=Zjsim)
                         Parameters[i,2] &lt;- estim.cf.sigma(Yj=Zjsim, FBM=F)
                         Parameters[i,3] &lt;- estim.cf.H(Yj=Zjsim, FBM=F)
                         Parameters[i,4] &lt;- estim.cf.alpha(Yj=Zjsim, FBM=T)}
                 #--- 3. Table of standard errors
                 SE &lt;- apply(Parameters, 2, sd)   
                 Boots[j,] &lt;- SE}
Boots &lt;- as.data.frame(Boots)
write.csv(Boots, file.path(output_supporting_path, 
                                &quot;T1b_selected_parameters_bootSE.csv&quot;)) </code></pre>
<pre class="r"><code>#=== T1b READING 
T1b.selParamSE &lt;- read.csv(file.path(output_supporting_path,
                                  &quot;T1b_selected_parameters_bootSE.csv&quot;))</code></pre>
<pre class="r"><code>T1 &lt;- data.frame(
  City = T1b.selParamSE$X,
  Hc = T1a.selParam$Hc,
  SE_Hc = T1b.selParamSE$SE_Hc,
  Hw = T1a.selParam$Hw,
  SE_Hw = T1a.selParam$SE_Hw
  #Alpha = T1a.selParam$Alpha,
  #SE_Alpha = T1b.selParamSE$SE_Alpha
) 

write.csv(T1, file.path(output_supporting_path,  &quot;T1_selected_parameters_estimation.csv&quot;))</code></pre>
<pre class="r"><code>Annual &lt;- matrix(0, nrow=njs, ncol=3)
colnames(Annual) &lt;- c(&quot;Hc.a&quot;,&quot;Hw.a&quot;,&quot;SE_Hw.a&quot;)
rownames(Annual) &lt;- paste0(selected$Country,&quot;, &quot;,selected$Station)

for (j in 1:njs) {
        #--- 1. Data reading 
        data &lt;- read.delim(data_dir_sel[j], header=F, na.strings=99)
        Xj &lt;- data[,14] 
        Zj &lt;- scale(Xj[!is.na(Xj)])
        #--- 2. Estimation
        Annual[j,1] &lt;- estim.cf.H(Yj=Zj, FBM=F)
        Annual[j,2] &lt;- estim.w.H(Zj=Zj)
        Annual[j,3] &lt;- WhittleEst(Zj)$coefficients[2]
        }

Annual &lt;- as.data.frame(Annual)

write.csv(Annual, 
          file.path(output_supporting_path, &quot;T1extra_annual_parameters_estim.csv&quot;))</code></pre>
<pre class="r"><code>T1 &lt;- read.csv(file.path(output_supporting_path,
                         &quot;T1_selected_parameters_estimation.csv&quot;), row.names = 1)

Annual &lt;- read.csv(file.path(output_supporting_path,
                             &quot;T1extra_annual_parameters_estim.csv&quot;), row.names = 1)

T1_ext &lt;- cbind(T1, Annual)

write.csv(T1_ext, 
          file.path(output_table_path, &quot;T1ext_selected_parameters_estimation.csv&quot;))</code></pre>
<pre class="r"><code>kable(T1_ext, digits=3, align=&#39;c&#39;, escape = T,
      col.names = c(&quot;City&quot;, &quot;H_c&quot;, &quot;SE(H_c)&quot;, &quot;H_w&quot;, &quot;SE(H_w)&quot;,
                    &quot;Ann. H_c&quot;, &quot;Ann. H_w&quot;, &quot;Ann. SE(H_w)&quot;))</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">City</th>
<th align="center">H_c</th>
<th align="center">SE(H_c)</th>
<th align="center">H_w</th>
<th align="center">SE(H_w)</th>
<th align="center">Ann. H_c</th>
<th align="center">Ann. H_w</th>
<th align="center">Ann. SE(H_w)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Germany, Berlin</td>
<td align="center">0.664</td>
<td align="center">0.009</td>
<td align="center">0.662</td>
<td align="center">0.012</td>
<td align="center">0.726</td>
<td align="center">0.712</td>
<td align="center">0.041</td>
</tr>
<tr class="even">
<td align="center">Switzerland, Geneva</td>
<td align="center">0.693</td>
<td align="center">0.001</td>
<td align="center">0.667</td>
<td align="center">0.012</td>
<td align="center">0.845</td>
<td align="center">0.818</td>
<td align="center">0.042</td>
</tr>
<tr class="odd">
<td align="center">Switzerland, Basel</td>
<td align="center">0.625</td>
<td align="center">0.011</td>
<td align="center">0.622</td>
<td align="center">0.012</td>
<td align="center">0.664</td>
<td align="center">0.720</td>
<td align="center">0.042</td>
</tr>
<tr class="even">
<td align="center">France, Paris</td>
<td align="center">0.733</td>
<td align="center">0.010</td>
<td align="center">0.672</td>
<td align="center">0.012</td>
<td align="center">0.873</td>
<td align="center">0.802</td>
<td align="center">0.042</td>
</tr>
<tr class="odd">
<td align="center">Sweden, Stockholm</td>
<td align="center">0.681</td>
<td align="center">0.015</td>
<td align="center">0.721</td>
<td align="center">0.012</td>
<td align="center">0.614</td>
<td align="center">0.632</td>
<td align="center">0.041</td>
</tr>
<tr class="even">
<td align="center">Italy, Milan</td>
<td align="center">0.724</td>
<td align="center">0.019</td>
<td align="center">0.709</td>
<td align="center">0.012</td>
<td align="center">0.851</td>
<td align="center">0.826</td>
<td align="center">0.043</td>
</tr>
<tr class="odd">
<td align="center">Czech Republic, Prague</td>
<td align="center">0.684</td>
<td align="center">0.015</td>
<td align="center">0.670</td>
<td align="center">0.012</td>
<td align="center">0.745</td>
<td align="center">0.716</td>
<td align="center">0.043</td>
</tr>
<tr class="even">
<td align="center">Hungary, Budapest</td>
<td align="center">0.627</td>
<td align="center">0.011</td>
<td align="center">0.645</td>
<td align="center">0.012</td>
<td align="center">0.682</td>
<td align="center">0.663</td>
<td align="center">0.043</td>
</tr>
<tr class="odd">
<td align="center">Denmark, Copenhagen</td>
<td align="center">0.755</td>
<td align="center">0.051</td>
<td align="center">0.758</td>
<td align="center">0.013</td>
<td align="center">0.817</td>
<td align="center">0.753</td>
<td align="center">0.045</td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="table-2.-selected-time-series-and-chi-square-test" class="section level3">
<h3>Table 2. Selected time series and Chi-square test</h3>
<p>Chi-square statistics of the FGN hypothesis for selected cities</p>
<pre class="r"><code>Q &lt;- matrix(0, nrow=njs, ncol=2)
for (j in 1:njs){
 data &lt;- read.delim(data_dir_sel[j], header=F, na.strings=99)
 Zm &lt;- monthlyAdj(data, scale=T)$Zm
 TT &lt;- length(Zm)
 Hc &lt;- estim.cf.H(Yj=Zm, FBM=F)
 Hw &lt;- estim.w.H(Zj=Zm)
 Q[j, ] &lt;- c(Qstat(Zm, H=Hc, TT=TT), Qstat(Zm, H=Hw, TT=TT))
}

monthly_Qt_sel &lt;- data.frame(stationame_sel, Q)

colnames(monthly_Qt_sel) &lt;- c(&quot;City&quot;, &quot;Q.Hc&quot;, &quot;Q.Hw&quot;)

#sum(Q&gt;1.96|Q&lt;(-1.96))

write.csv(monthly_Qt_sel, row.names=F,
          file.path(output_table_path, &quot;T2_monthly_Qt_sel.csv&quot;))</code></pre>
<pre class="r"><code>kable(monthly_Qt_sel, digits=3, align=&#39;c&#39;,
      col.names = c(&quot;City&quot;, &quot;$Q(H_c)$&quot;, &quot;$Q(H_w)$&quot;))</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">City</th>
<th align="center"><span class="math inline">\(Q(H_c)\)</span></th>
<th align="center"><span class="math inline">\(Q(H_w)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Germany, Berlin</td>
<td align="center">-0.518</td>
<td align="center">-0.626</td>
</tr>
<tr class="even">
<td align="center">Switzerland, Geneva</td>
<td align="center">-0.222</td>
<td align="center">-1.622</td>
</tr>
<tr class="odd">
<td align="center">Switzerland, Basel</td>
<td align="center">-0.409</td>
<td align="center">-0.484</td>
</tr>
<tr class="even">
<td align="center">France, Paris</td>
<td align="center">1.286</td>
<td align="center">-2.791</td>
</tr>
<tr class="odd">
<td align="center">Sweden, Stockholm</td>
<td align="center">-1.209</td>
<td align="center">1.098</td>
</tr>
<tr class="even">
<td align="center">Italy, Milan</td>
<td align="center">-1.339</td>
<td align="center">-2.335</td>
</tr>
<tr class="odd">
<td align="center">Czech Republic, Prague</td>
<td align="center">-0.198</td>
<td align="center">-0.855</td>
</tr>
<tr class="even">
<td align="center">Hungary, Budapest</td>
<td align="center">-0.819</td>
<td align="center">-0.255</td>
</tr>
<tr class="odd">
<td align="center">Denmark, Copenhagen</td>
<td align="center">-1.006</td>
<td align="center">-0.693</td>
</tr>
</tbody>
</table>
<hr />
<hr />
</div>
</div>
<div id="figures" class="section level1">
<h1>FIGURES</h1>
<div id="figure-1.-illustration-of-statistical-self-similarity.-annual-temperature-for-paris" class="section level3">
<h3>Figure 1. Illustration of statistical self-similarity. Annual temperature for Paris</h3>
<hr />
</div>
<div id="figure-2.-graphical-tests-of-self-similarity-and-normality" class="section level3">
<h3>Figure 2. Graphical tests of self-similarity and normality</h3>
<pre class="r"><code>par(mfrow=c(3,2))
for (j in 1:njs){
  data &lt;- read.delim(data_dir_sel[j], header=F, na.strings=99)
  Zm &lt;- monthlyAdj(data, scale=T)$Zm
  Ym &lt;- cumsum(Zm)
  fgtSelfSim(Yj=Ym, main=paste(&quot;-&quot;,stationame_sel[j]), maxd=20,
             cex.dots=1.5, cex.axis=1, cex.main=1.2, subtitle=F)
  fgtNormality(Yj=Ym, main=paste(&quot;-&quot;,stationame_sel[j]), cex.dots=1.5,
               cex.axis=1, cex.main=1.2)}</code></pre>
<pre class="r"><code>par(mfrow=c(3,2))
for (j in 1:njs){
  data &lt;- read.delim(data_dir_sel[j], header=F, na.strings=99)
  Zm &lt;- monthlyAdj(data, scale=T)$Zm
  Ym &lt;- cumsum(Zm)
  fgtSelfSim(Yj=Ym,main=paste(&quot;-&quot;,stationame_sel[j]), maxd=20,
             cex.dots=1.5, cex.axis=1, cex.main=1.2, subtitle=F)
  fgtNormality(Yj=Ym,main=paste(&quot;-&quot;,stationame_sel[j]), cex.dots=1.5,
               cex.axis=1, cex.main=1.2)}</code></pre>
<hr />
</div>
<div id="figure-3.-simulated-fgn-process-with-zero-mean-and-unit-variance" class="section level3">
<h3>Figure 3. Simulated FGN process with zero mean and unit variance</h3>
<pre class="r"><code>TT &lt;- 1000
x &lt;- set.seed(123)
for (H in c(0.7, 0.8, 0.9)){
  Xj &lt;- simFGN0(TT, H)
  temperaturePlot(Xj = Xj, Year = 1:TT, main = paste0(&quot;FGN simulation, H=&quot;, H),
                  cex.lab = 1, cex.main = 1.2, cex.axis = 1)
}</code></pre>
<hr />
</div>
<div id="figure-4.-reconstructed-temperature-data-by-moberg-et-al.-2005a" class="section level3">
<h3>Figure 4. Reconstructed temperature data by Moberg et al. (2005a)</h3>
<pre class="r"><code>temperaturePlot(Xj = Xj_m, Year = Year_m, 
                  cex.lab = 1, cex.main = 1.2, cex.axis = 1)</code></pre>
<hr />
</div>
<div id="figure-5.-test-of-self-similarity-and-normality" class="section level3">
<h3>Figure 5. Test of self-similarity and normality</h3>
<p>Reconstructed temperature data by Moberg et al. (2005a)</p>
<pre class="r"><code>fgtSelfSim(Yj = Yj_m, maxd=20, 
           cex.dots=1, cex.axis=1, cex.main=1)$plot</code></pre>
<pre class="r"><code>fgtNormality(Yj = Yj_m, cex.dots=1, cex.axis=1, cex.main=1)$plot</code></pre>
<hr />
</div>
<div id="figure-6.-empirical-vs-fgn-autocorrelations" class="section level3">
<h3>Figure 6. Empirical vs FGN autocorrelations</h3>
<p>Reconstructed temperature data by Moberg et al. (2005a)</p>
<p>Empirical vs FGN autocorrelation with confidence bands. H=0.95</p>
<pre class="r"><code>N &lt;- 1000
d &lt;- 40

# Moberg unbiased autocorrelation
unbiased_autocorr_moberg &lt;- unbiased_autocorrelation_function(d, moberg$T)

# Theoretical autocorrelation
gamma_k &lt;- Theoretical_autocorrelation_function(d)

# FGN simulation
fgn_tbl &lt;- sim.multiFGN(N = N, Tj = 2000, H = 0.95)

# Bootstrap estimation
unbiased_autocorr_sim_tbl &lt;- numeric(0)
for (i in 1:length(fgn_tbl)) {
  a &lt;- fgn_tbl %&gt;% select(i)
  X &lt;- as.numeric(unlist(a))
  X_unbiased_autocorr &lt;- as.vector(unbiased_autocorrelation_function(d, X))
  unbiased_autocorr_sim_tbl &lt;- cbind(unbiased_autocorr_sim_tbl,
                                     X_unbiased_autocorr)
}

# Bootstrap mean and sd
unbiased_autocorr_sim_mean &lt;- apply(unbiased_autocorr_sim_tbl, 1, mean) 
unbiased_autocorr_sim_sd &lt;- apply(unbiased_autocorr_sim_tbl, 1, sd)

# Autocorrelation tbl
unbiased_autocorr_tbl &lt;- 
  data.frame(Theoretical = gamma_k, 
             simulated = unbiased_autocorr_sim_mean,
             sd_simulated = unbiased_autocorr_sim_sd,
             Moberg = unbiased_autocorr_moberg) %&gt;%
  mutate(Lag = row_number(),
         CI_inf = Theoretical - 2*sd_simulated,
         CI_sup = Theoretical + 2*sd_simulated)

write.csv(unbiased_autocorr_tbl, file.path(output_supporting_path, &quot;FD4_Unbiased_autocorrelation_tbl.csv&quot;), row.names = F)</code></pre>
<pre class="r"><code>unbiased_autocorr_tbl &lt;- read.csv(
  file.path(output_supporting_path, &quot;FD4_Unbiased_autocorrelation_tbl.csv&quot;))

unbiased_autocorr_tbl_long &lt;- unbiased_autocorr_tbl %&gt;%
  gather(key = &quot;Autocorrelation&quot;, value = &quot;Value&quot;, 
         -Lag, - simulated, -sd_simulated, -CI_inf, -CI_sup)</code></pre>

<pre class="r"><code>  unbiased_autocorr_tbl_long %&gt;%
  ggplot(aes(x = Lag, y = Value, colour = Autocorrelation)) +
  ylim(0, 1) +
  geom_ribbon(aes(ymin = CI_inf, ymax = CI_sup), 
              fill = &quot;blue&quot;, col = &quot;white&quot;, alpha = 0.2) +
  geom_line()  +
  geom_point() +
  scale_colour_manual(values = c(&quot;red&quot;, &quot;blue&quot;),
                      labels = c(&quot;Empirical&quot;, &quot;FGN model&quot;)) +
  theme_minimal() +
  theme(legend.position = &quot;bottom&quot;) +
  labs(y = &quot;Autocorrelation&quot;)</code></pre>
</div>
</div>

                        </div>
                        
                        

                    </div>
                    

                    

                    

                    <div class="col-md-3">

                        

                        

<div class="panel panel-default sidebar-menu">

    <div class="panel-heading">
      <h3 class="panel-title">Search</h3>
    </div>

    <div class="panel-body">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" role="search">
            <div class="input-group">
                <input type="search" name="q" class="form-control" placeholder="Search">
                <input type="hidden" name="sitesearch" value="/">
                <span class="input-group-btn">
                    <button type="submit" class="btn btn-template-main"><i class="fas fa-search"></i></button>
                </span>
            </div>
        </form>
    </div>
</div>







<div class="panel panel-default sidebar-menu">

    <div class="panel-heading">
        <h3 class="panel-title">Categories</h3>
    </div>

    <div class="panel-body">
        <ul class="nav nav-pills nav-stacked">
            
            
            <li>
                <a href="/categories/r">r (1)</a>
            </li>
            
            <li>
                <a href="/categories/research">research (5)</a>
            </li>
            
        </ul>
    </div>

</div>








<div class="panel sidebar-menu">

    <div class="panel-heading">
        <h3 class="panel-title">Tags</h3>
    </div>

    <div class="panel-body">
        <ul class="tag-cloud">
            
            
            <li>
                <a href="/tags/fgn"><i class="fas fa-tags"></i> fgn</a>
            </li>
            
            <li>
                <a href="/tags/plot"><i class="fas fa-tags"></i> plot</a>
            </li>
            
            <li>
                <a href="/tags/r"><i class="fas fa-tags"></i> r</a>
            </li>
            
            <li>
                <a href="/tags/regression"><i class="fas fa-tags"></i> regression</a>
            </li>
            
            <li>
                <a href="/tags/research"><i class="fas fa-tags"></i> research</a>
            </li>
            
            <li>
                <a href="/tags/temperature"><i class="fas fa-tags"></i> temperature</a>
            </li>
            
        </ul>
    </div>

</div>






                        

                    </div>
                    

                    

                </div>
                

            </div>
            
        </div>
        

        <footer id="footer">
    <div class="container">

        
        <div class="col-md-4 col-sm-6">
            <h4>About us</h4>

            Vanlog is a group of data scientists born around a common goal: bringing the power of data everywhere. We believe in open source solutions and we specializes in R, the programming language for statistical solutions

            <hr class="hidden-md hidden-lg hidden-sm">

        </div>
        
        

        <div class="col-md-4 col-sm-6">

             
            <h4>Recent posts</h4>

            <div class="blog-entries">
                
            </div>

            <hr class="hidden-md hidden-lg">
             

        </div>
        

        
        <div class="col-md-4 col-sm-6">

          <h4>Contact</h4>

            <p class="text-uppercase"><strong>Vanlog</strong>
      </p>
      

            <a href="/contact" class="btn btn-small btn-template-main">Go to contact page</a>

            <hr class="hidden-md hidden-lg hidden-sm">

        </div>
        
        

    </div>
    
</footer>







<div id="copyright">
    <div class="container">
        <div class="col-md-12">
            
            <p class="pull-left">Copyright (c) 2020, Vanlog; all rights reserved.</p>
            
            <p class="pull-right">
              Template by <a href="https://bootstrapious.com/p/universal-business-e-commerce-template">Bootstrapious</a>.
              

              Ported to Hugo by <a href="https://github.com/devcows/hugo-universal-theme">DevCows</a>.
            </p>
        </div>
    </div>
</div>





    </div>
    

    
<script src="//code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0/jquery.counterup.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-parallax/1.1.3/jquery-parallax.js"></script>

<script src="//maps.googleapis.com/maps/api/js?v=3.exp"></script>

<script src="/js/hpneo.gmaps.js"></script>
<script src="/js/gmaps.init.js"></script>
<script src="/js/front.js"></script>


<script src="/js/owl.carousel.min.js"></script>



  </body>
</html>
